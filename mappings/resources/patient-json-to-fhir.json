{
	"id": "patient-json-to-fhir-v1",
	"name": "Patient JSON to FHIR Mapping",
	"version": "1.0.0",
	"direction": "JSON_TO_FHIR",
	"sourceType": "PatientDTO",
	"targetType": "Patient",
	"fieldMappings": [
		{
			"id": "patient-identifier-value",
			"sourcePath": "patientId",
			"targetPath": "identifier[0].value",
			"dataType": "string",
			"required": true
		},
		{
			"id": "patient-identifier-system",
			"sourcePath": null,
			"targetPath": "identifier[0].system",
			"dataType": "string",
			"defaultValue": "$ctx.settings[\"identifierSystem\"]",
			"required": true
		},
		{
			"id": "patient-name-family",
			"sourcePath": "lastName",
			"targetPath": "name[0].family",
			"dataType": "string",
			"required": true
		},
		{
			"id": "patient-name-given",
			"sourcePath": "firstName",
			"targetPath": "name[0].given[0]",
			"dataType": "string",
			"required": true
		},
		{
			"id": "patient-gender",
			"sourcePath": "gender",
			"targetPath": "gender",
			"dataType": "code",
			"lookupTable": "gender-lookup",
			"required": true,
			"description": "Converts M->male, F->female"
		},
		{
			"id": "patient-birthdate",
			"sourcePath": "dateOfBirth",
			"targetPath": "birthDate",
			"dataType": "date",
			"transformExpression": "fn:formatDate(value, 'yyyy-MM-dd')",
			"required": false
		},
		{
			"id": "patient-managing-org",
			"sourcePath": null,
			"targetPath": "managingOrganization.reference",
			"dataType": "string",
			"transformExpression": "fn:concat('Organization/', $ctx.organizationId)",
			"condition": "$ctx.organizationId != null",
			"required": false
		}
	]
}